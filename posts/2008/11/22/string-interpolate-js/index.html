<!DOCTYPE html>
<html lang="ru">
<head>
	<title>String.interpolateJS() — Блог Конфуция</title>
	<!--# include virtual="/inc/common-head.html" -->
</head>
<body>
<!--# include virtual="/inc/common-top.html" -->
<div class="main-wrapper">

<a href="/" class="blog-name">Блог Конфуция</a>

<div class="post">
	<section>
		<h class="title">String.interpolateJS()</h>
		<span class="date">22.11.2008</span>
		<section class="content">
		<p>Помогает запихнуть в строку немного яваскрипта. Функция очень полезна во всяких ленгвиджпаках. Весь яваскрипт выполняется без ограничений, так что будьте бдительны.</p>

<p>Скачайте <a href="http://www.cmsbuilder.ru/blog/wp-content/uploads/2008/11/interpolate.js">версию 1.0b</a> (<a href="http://www.cmsbuilder.ru/blog/wp-content/uploads/2008/11/interpolate.mini.js">mini</a>) — наверняка пригодится ;)</p>

<pre><code class="javascript">
"Welcome to ${company}!".interpolateJS({company:'Programica'})
//=> "Welcome to Programica!"

"Your name is ${name}.".interpolateJS({name:prompt('What is your name?')})
//=> "Your name is Dima."

// tru javascript inside :)
"Your name is ${prompt('What is your name?')}.".interpolateJS({})
//=> "Your name is Dima."

"${this.interpolateJS({})}".interpolateJS({})
// too much recursion

("${another = 'another', 'Just'} ${another}"+
    " ${'tpircSavaJ'.split('').reverse().join('')}"+
    " ${[\"hacker\"] || '{{}}'},").interpolateJS({another:1})
//=> "Just another JavaScript hacker,"
</code></pre>

<p>Компиляция нужна только при первой интерполяции строки, так как полученная после парсинга функция кешируется. Исходя из этого, первое обращение к <code>interpolateJS()</code> будет медленнее последующих.</p>

<p>Чтобы получить закешированную функцию по строке, обратитесь к объекту <code>String.prototype.interpolateJS.cache</code>:
<pre><code class="javascript">
var string = "${x} + 2 = ${ x + 2 } :)"
string.interpolateJS({x:2})
//=> "2 + 2 = 4 :)"

String.prototype.interpolateJS.cache[string]
//=> function ($_$h) { with ($_$h) { return x + $_$s[1] + (x + 2); } }
</code></pre>
</p>
		</section>
	</section>
	
	<dl class="tags">
		<dt class="head">Теги:</dt>
		<dd class="body">
			<ul class="list"><li class="tag">клиент</li><li class="tag">eval</li><li class="tag">interpolate</li><li class="tag">javascript</li><li class="tag">parsing</li><li class="tag">string</li><li class="tag">with</li></ul>
		</dd>
	</dl>
	
	<div class="comments">Очень жду ваших комментариев <a href="mailto:Комментарии блога Конфуция <comments@kung-fu-tzu.ru>?subject=Re: String.interpolateJS()">на почту</a>.</div>
</div>

</div>
<!--# include virtual="/inc/common-bottom.html" -->
</body>
</html>